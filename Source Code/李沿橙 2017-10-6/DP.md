# 讲题

T1 陈兄准备跑圈吧

T2 很多人瞎贪贪错了，比如陈兄

用差分约束

设招进来的人为s[i]
s[i] - s[i - 8] >= a[i]
s[23] - s[i + 16] + s[i] >= a[i]
0 <= s[i] - s[i - 1] <= b[i]
二分s[23]

T3
`DP[i][j] = dp[i - 1][j] + (dp[i - 1][j - 1] * a[i])`
线段树
存`f[node][k]`
`f[L(p)][j] * f[R(p)][j]`
`(a1 + x)(a2 + x)(a3 + x)`

标记先反再加
乘起来$f[i] = ∑_{j = 0} ^i f_{lc}(j) * f_{rc}(i - j)$
取反：奇数反号，偶数不动

f[i] = a1 a2 a3 a4
f[i] = a1+c a2+c a3+c
a1a2a3a4c $^{i - j}$

O(k ^ 2 * n * log n)

# DP（的~~假~~6优化）

分类：1.经典模~~式~~型 2.手推简单方程 3.做不来了 4.慢DP：优化大王来搞

##~~慢~~要优化的DP

类型1：没有固定套路
方法：分析问题的本质，减少不必要的状态和转移。

Eg CUT （51Node 算法马拉松3 Tree）
`f[u][i]`u为根，i为当前连通块大小

类型2
$f(i) = min^{i - 1} _{j = b[i]} \{ g(j) \} + w[i]$

单调队列
元素值单调的双端队列

类型3
$f(i) = min^{i - 1} _ {j = 1} \{ g(j) + w[i, j] \} + a(i)$

决策单调性：若对于状态f(i)，决策j’比j优，且j<j‘，那么对于任意i‘ > i的状态f(i')，决策j'仍然比j优的性质
设状态i的最优决策为t(i)，则可推出t(i) <= t(i') (i < i')
# j    j'    i     i'

设s(i, j) = $f_{i, j}$ = g(j) + w[i, j] + a(i)
s(i, j') <= s(i, j)  =>  s(i', j') <= s(i', j) ，对任意i < i'，j < j'都要成立
代入展开
得到充分条件 $w[i',j'] - w[i, j'] <= w[i',j]-w[i,j]$
w[i',j]+w[i,j']>=w[i',j']+w[i,j]

四边形不等式：
w[i,j] + w[i + 1, j + 1] <= w[i + 1, j] + w[i, j + 1]

当w[i, x]为凸函数时，f(x)具有决策单调性
实际上可以打表来查看，不必严格证明

想法一：枚举i的决策时不从1开始，而从i - 1的最优决策t(i - 1)开始（只是常数优化）
想法二：从i - 1的最优决策开始枚举，当遇到决策j + 1没有决策j优就停止枚举（不能保证正确性）
想法三：换一个角度？用已经计算出的状态去更新其它状态

类型4
$$f[i] = min_{j = 1} ^ {i - 1} \{ a[i] * x[j] + b[i] * y[j] \} + c[i]$$

变形后 $y[j] = - \frac {a[i]}{b[i]} x[j] + \frac {1} {b[i]} f[i]$
将决策j视为二维平面上的点，则上面式子可看作y = kx + b
截距最大或最小。
若x[j]单调，则单调队列
若x[j]不单调，则用平衡树来动态维护凸壳。



